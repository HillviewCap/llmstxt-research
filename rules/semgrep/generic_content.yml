rules:
  - id: generic.suspicious.command-injection
    languages: [generic]
    message: "Potential command injection detected in generic content"
    severity: WARNING
    category: security
    priority: Medium
    pattern: |
      (?:system|exec|popen|subprocess\.Popen|subprocess\.call|subprocess\.run|os\.system|eval|execfile)\s*\(.*\$.*\)
    metadata:
      cwe: "CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')"
      references:
        - https://owasp.org/www-community/attacks/Command_Injection

  - id: generic.suspicious.url
    languages: [generic]
    message: "Suspicious URL pattern detected"
    severity: INFO
    category: security
    priority: Low
    pattern: |
      (?:http|https|ftp)://(?:[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?\.)+[a-zA-Z]{2,}(?:/[^\s'"]*)?
    metadata:
      description: "Identifies URLs in generic content for further review"

  - id: generic.suspicious.api-key
    languages: [generic]
    message: "Potential API key or token pattern detected"
    severity: WARNING
    category: security
    priority: Medium
    pattern: |
      (?:api[_-]?key|token|secret|password|credential)[_-]?(?:=|\s*:)\s*['"][a-zA-Z0-9_\-\.]{16,}['"]
    metadata:
      cwe: "CWE-798: Use of Hard-coded Credentials"
      references:
        - https://owasp.org/www-community/vulnerabilities/Use_of_hard-coded_password